# TreeSitter

This gem wraps around [tree-sitter](https://github.com/tree-sitter/tree-sitter).

## Installation

Add this line to your application's Gemfile:

```ruby
gem 'tree-sitter'
```

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install tree-sitter

## Usage

Tree-sitter performs [two different operations](https://github.com/tree-sitter/tree-sitter#overview): compiling grammars and parsing text with those grammars.

This gem is only concerned with parsing a blob of text, given the appropriate grammars. Compiling grammars from JSON is trivial and can just be kept as an executable generated from C.

### Running a parser

The libruntime static library needs to make use of the C code generated by the libcompile executable. Once you've got those, you'll need to provide an absolute path to the directory containing the C files that the library can incorporate. For example:

``` bash
# if you've installed this gem
$ TREE_SITTER_PARSER_DIR=/somewhere/code bundle install
# if you're using this gem locally
$ TREE_SITTER_PARSER_DIR=/somewhere/code bundle exec rake compile
```

This directory is appended with the glob suffix `**/*.{c,cc}`, so it can contain as many nested parser files as necessary.

Then, you can start making use of the parser:

``` ruby
document = TreeSitter::Document.new
# provide the function name
document.language = "tree_sitter_arithmetic"
document.language = 'tree_sitter_arithmetic'
# provide the input
document.input_string = 'a + b * 5'
# parse it
document.parse
```

## Development

After checking out the repo, run `script/bootstrap` to install dependencies. Then, run `bundle exec rake test` to run the tests. You can also run `bin/console` for an interactive prompt that will allow you to experiment.
